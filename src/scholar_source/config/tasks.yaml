course_analysis_task:
  description: >
    Analyze the provided book and course information to extract the book's table of contents,
    key topics, and learning structure. The primary goal is to understand what topics the 
    student's book covers so we can find similar resources.
    
    **Input Sources (use whatever is available):**
    - Book information: book_title, book_author, isbn, book_url
    - PDF file: book_pdf_path (use FileReadTool to read and extract table of contents)
    - Course information: university_name, course_name, course_url
    - Additional context: textbook, topics_list
    
    **Your Analysis Tasks:**
    1. Extract the book's table of contents and major topics/chapters
       - If PDF is provided, read it to find the table of contents
       - If book_url is provided, extract book structure from web pages
       - If only book title/author/ISBN is provided, infer likely topics based on the book
    2. Identify 5-10 major topic areas or chapters from the book
    3. Determine course level (introductory/intermediate/advanced/professional)
    4. Identify the discipline area (e.g., "Algorithms", "Calculus", "Organic Chemistry")
    5. Note any specific learning objectives or skills the book focuses on
    
    **Priority:**
    - If a PDF is provided, prioritize extracting the actual table of contents from it
    - If book_url is provided, extract book structure from web pages
    - Use book metadata (title, author, ISBN) to infer structure if other sources unavailable
    - Use course information (university_name, course_name, course_url) for additional context
    
    Available input variables (all optional):
    university_name, course_name, course_url, textbook, topics_list,
    book_title, book_author, isbn, book_pdf_path, book_url

    The following inputs were provided:
    {university_name}
    {course_name}
    {course_url}
    {textbook}
    {topics_list}
    {book_title}
    {book_author}
    {isbn}
    {book_pdf_path}
    {book_url}

    Note: Not all input variables will be populated. Use whatever is available to extract
    the book's structure and topics.
  expected_output: >
    A structured analysis containing:
    
    - course_title: The formal or informal course name
    - topics: A comprehensive list of topics/units/concepts (minimum 3-5, maximum 15)
    - official_textbooks: List of textbooks mentioned (title and author)
    - course_level: "introductory" | "intermediate" | "advanced" | "professional"
    - key_concepts: List of the most important concepts students should master
    - discipline_area: The academic field (e.g., "Physics", "Computer Science")
    - estimated_duration: Rough estimate like "semester-long" or "self-paced"
    - learning_context: Brief note about the educational setting if known
    
    Format as a clean JSON object or structured text that subsequent agents can easily parse.
  agent: course_intelligence_agent

resource_search_task:
  description: >
    Based on the book analysis, search for 5-7 high-quality resources that follow a similar 
    structure to the student's book. These resources should complement the book's table of 
    contents and be suitable for adding to NotebookLM.
    
    **Priority Resource Types (in order):**
    1. Open textbooks (OpenStax, MIT OpenCourseWare PDFs, LibreTexts, etc.) with similar table of contents
    2. University course materials (MIT OCW, Stanford, Yale Open Courses) - PDFs and web pages with text content
    3. Educational platform content (Khan Academy, Coursera free lectures, edX) - text-based materials
    4. Interactive learning sites (Paul's Online Math Notes, Physics Classroom, etc.) with text content
    5. Peer-reviewed open access papers for advanced topics
    6. University lecture videos on YouTube (MIT OCW, Stanford, Yale Open Courses, etc.) - as supplementary resources
    
    **Search Strategy:**
    - Focus on finding resources that cover similar topics to the book's chapters
    - Aim for 5-7 total resources - quality over quantity
    - Prioritize text-based resources (PDFs, web pages) that NotebookLM can easily process
    - Include YouTube videos only as supplementary resources when high-quality text alternatives aren't available
    - Match the course level (don't suggest PhD-level for intro books)
    
    **Quality Criteria:**
    - Must be legally free and publicly accessible (no pirated content)
    - Must be from reputable sources (universities, established ed platforms)
    - Should align with the book's table of contents structure
    - Must be compatible with NotebookLM (PDF, web page, or YouTube URL)
    - Prioritize text-based content (PDFs, web pages) that NotebookLM can easily process and extract information from
    - YouTube videos should only be included when they provide unique value not available in text format
    
    **Search Approach:**
    Use web search to find resources. Search terms should prioritize text-based content:
    - "[book title] open textbook pdf"
    - "[book topic] open textbook pdf"
    - "[book topic] MIT OpenCourseWare PDF"
    - "[book topic] open access textbook"
    - "[book topic] course notes pdf"
    - "[book topic] lecture notes"
    - "[book topic] university course materials"
    - "[book topic] lecture video YouTube" (only if text alternatives are limited)
    
    Focus on finding resources that students can add to NotebookLM alongside their book
    to create comprehensive study materials (flashcards, quizzes, etc.).

    Use the output from the course_analysis_task to guide your search.
  expected_output: >
    A curated list of 5-7 recommended resources that complement the student's book, each containing:
    
    - resource_title: Full title of the resource
    - resource_type: "open_textbook" | "video_lecture" | "lecture_series" | 
      "interactive_tutorial" | "course_notes" | "educational_video"
    - url: Direct link to the resource (must be accessible without login)
    - coverage_topics: List of book topics/chapters this resource addresses
    - source_credibility: Origin (e.g., "MIT OpenCourseWare", "OpenStax", "Khan Academy")
    - content_scope: "comprehensive" | "supplementary" | "topic-specific"
    - access_notes: Confirmation that it's free, legal, and openly accessible
    - estimated_depth: "introductory" | "intermediate" | "advanced"
    - alignment_with_book: Brief note on how this resource aligns with the book's structure

    Organize resources clearly. Include brief reasoning for why each resource was selected
    and how it complements the student's book.
  agent: resource_discovery_agent

resource_validation_task:
  description: >
    Validate each resource discovered by the resource_discovery_agent to ensure it
    meets quality, legal, and technical requirements. For each resource:
    
    **Accessibility Checks:**
    1. Verify the URL is functional and publicly accessible (no 404s, no paywalls)
    2. Confirm no login or payment is required
    3. Check that the content actually loads (use web_fetch if needed for URLs)
    
    **NotebookLM Compatibility Checks:**
    1. Verify format compatibility:
       - PDFs: Must be direct PDF links (not HTML pages about PDFs)
       - YouTube: Must be standard youtube.com or youtu.be URLs
       - Web pages: Must be publicly accessible HTML pages
    2. Check file size if PDF (NotebookLM has limits, typically under 500MB)
    
    **Legal and Copyright Checks:**
    1. Look for clear licensing information (Creative Commons, Open Access, etc.)
    2. Verify the source is reputable and authorized to distribute
    3. Flag any resources that appear to be pirated or unauthorized copies
    4. Ensure it's not behind academic journal paywalls
    
    **Quality Checks:**
    1. Assess content relevance to the course topics
    2. Evaluate source credibility and academic rigor
    3. Check for comprehensiveness (not just snippets or summaries)
    4. Verify alignment with stated course level
    
    **Filtering Criteria - REMOVE resources that:**
    - Require login, subscription, or payment
    - Are pirated or copyright-infringing materials
    - Have broken or inaccessible links
    - Are low quality, incomplete, or off-topic
    - Are not NotebookLM compatible
    - Lack clear legal authorization for public access
    
    Score each approved resource on usefulness (1-10) based on:
    - Relevance to course topics (40%)
    - Comprehensiveness of coverage (30%)
    - Source credibility (20%)
    - User-friendliness (10%)

    Use the resources discovered by the previous task as your input.
  expected_output: >
    A filtered and validated list of resources, each containing:
    
    - All original resource fields from the search task
    - validation_status: "approved" | "rejected"
    - rejection_reason: Detailed explanation if rejected
    - notebooklm_compatible: true | false
    - notebooklm_format: "pdf" | "youtube" | "webpage" | "not_compatible"
    - license_info: Copyright/license information found
    - accessibility_verified: true | false
    - usefulness_score: 1-10 (integer)
    - validation_notes: Any important notes about the resource
    
    **Summary Statistics:**
    - Total resources validated: X
    - Approved: X
    - Rejected: X
    - Average usefulness score: X.X
    
    Only include APPROVED resources in the final list. Aim for 5-7 high-quality 
    approved resources total. If fewer than 5 pass validation, note this in the output.
  agent: resource_validator_agent

final_output_task:
  description: >
    Create a student-friendly, actionable resource guide that students can 
    immediately use to enhance their learning with Google NotebookLM.
    
    **Guide Structure:**
    
    1. **Course Overview Section:**
       - Brief description of the course/book
       - Key topics that will be covered
       - Learning objectives or skills to develop
    
    2. **Recommended Resources Section:**
       - Organize resources by topic area or resource type (choose most logical)
       - For each resource include:
         * Clear title and resource type
         * Direct clickable URL
         * Brief description (2-3 sentences) of what it covers and why it's useful
         * Which specific topics it addresses
         * Estimated time/scope (e.g., "Full textbook", "5-part video series", "Single lecture")
    
    3. **How to Add to NotebookLM Section:**
       - Step-by-step instructions for adding each type of resource
       - Tips for organizing sources within NotebookLM
       - Suggestions for how to use multiple sources effectively
    
    4. **Study Tips Section:**
       - How to leverage NotebookLM's features with these sources
       - Suggested study workflow (e.g., create flashcards, generate practice questions)
       - Tips for getting the most value from multiple perspectives
    
    **Formatting Guidelines:**
    - Use clear headers and subheaders
    - Keep descriptions concise but informative
    - Make URLs easily clickable
    - Use bullet points and numbered lists for readability
    - Add emoji or visual markers sparingly for key sections
    - Keep total guide length to 2-4 pages when printed
    
    **Tone:**
    - Encouraging and supportive
    - Clear and jargon-free
    - Action-oriented (tell students exactly what to do)
    - Assume student may not be tech-savvy

    Use the validated resources and course analysis from previous tasks to create
    a comprehensive student-friendly guide.
  expected_output: >
    A formatted markdown document ready to present to the student:
    
    # Study Resources for [Course Name]
    
    ## üìö Course Overview
    [2-3 sentence description of what this course covers and what students will learn]
    
    **Key Topics:**
    - Topic 1
    - Topic 2
    - Topic 3
    [etc.]
    
    ---
    
    ## üéØ Recommended Resources
    
    I've found [X] high-quality, free resources to supplement your learning:
    
    ### [Topic Area 1] or [Resource Type 1]
    
    **1. [Resource Title]** (Type: Textbook/Video/etc.)
    - **Link:** [Direct URL]
    - **What it covers:** [Brief description highlighting value]
    - **Best for:** [When/how to use this resource]
    - **Usefulness Score:** ‚≠êÔ∏è [X/10]
    
    **2. [Next resource]**
    [Same format]
    
    ### [Topic Area 2] or [Resource Type 2]
    [Continue...]
    
    ---
    
    ## üì• How to Add These to NotebookLM
    
    **For PDFs:**
    1. Click the link to open the PDF
    2. In NotebookLM, click "+ New Source"
    3. Select "Upload" and choose the PDF file
    
    **For YouTube Videos:**
    1. Copy the YouTube URL
    2. In NotebookLM, click "+ New Source"
    3. Select "YouTube URL" and paste the link
    
    **For Web Pages:**
    1. Copy the webpage URL
    2. In NotebookLM, click "+ New Source"
    3. Select "Website URL" and paste the link
    
    ---
    
    ## üí° Study Tips
    
    **Using Multiple Sources:**
    - [Tip 1]
    - [Tip 2]
    - [Tip 3]
    
    **Maximizing NotebookLM:**
    - Use the chat feature to ask questions across all sources
    - Generate study guides from multiple perspectives
    - Create flashcards from the combined knowledge base
    - Use the audio overview feature to hear key concepts explained
    
    ---
    
    **Total Resources:** [X] carefully vetted, free, and legal educational materials
    
    **Need More Help?** [Optional: suggestions for finding additional resources]
    
    ---
    
    *All resources are freely and legally accessible. No pirated content included.*
  agent: output_formatter_agent